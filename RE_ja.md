# Oniguruma++ 正規表現仕様

**バージョン 6.9.15** — 2025/11/26

---

## 1. 構文要素

| 要素 | 説明 |
|------|------|
| `\` | エスケープ（メタ文字の有効化・無効化） |
| `|` | オルタネーション（選択） |
| `(...)` | グループ |
| `[...]` | 文字クラス |

---

## 2. 文字

### 文字エスケープ

| エスケープ | 説明 | 値 |
|------------|------|-----|
| `\t` | 水平タブ | `0x09` |
| `\v` | 垂直タブ | `0x0B` |
| `\n` | 改行（ラインフィード） | `0x0A` |
| `\r` | キャリッジリターン | `0x0D` |
| `\b` | バックスペース | `0x08` |
| `\f` | フォームフィード | `0x0C` |
| `\a` | ベル | `0x07` |
| `\e` | エスケープ | `0x1B` |
| `\nnn` | 8進数文字 | エンコードされたバイト値 |
| `\xHH` | 16進数文字 | エンコードされたバイト値 |
| `\x{7HHHHHHH}` | 16進数文字（1-8桁） | コードポイント値 |
| `\o{17777777777}` | 8進数文字（1-11桁） | コードポイント値 |
| `\uHHHH` | 16進数文字 | コードポイント値 |
| `\cx` | コントロール文字 | コードポイント値 |
| `\C-x` | コントロール文字 | コードポイント値 |
| `\M-x` | メタ（x\|0x80） | コードポイント値 |
| `\M-\C-x` | メタコントロール文字 | コードポイント値 |

> **注意:** バックスペースとしての`\b`は文字クラス内でのみ有効です。

### 2.1 コードポイントシーケンス

**16進数コードポイント**（1-8桁）:
```
\x{7HHHHHHH 7HHHHHHH ... 7HHHHHHH}
```

**8進数コードポイント**（1-11桁）:
```
\o{17777777777 17777777777 ... 17777777777}
```

---

## 3. 文字タイプ

### 基本文字タイプ

| パターン | 説明 |
|----------|------|
| `.` | 任意の文字（改行を除く） |
| `\w` | 単語文字 |
| `\W` | 非単語文字 |
| `\s` | 空白文字 |
| `\S` | 非空白文字 |
| `\d` | 10進数字文字 |
| `\D` | 非10進数字文字 |
| `\h` | 16進数字文字 `[0-9a-fA-F]` |
| `\H` | 非16進数字文字 |

### 単語文字（`\w`）

**非Unicode:**
- 英数字、"_"、およびマルチバイト文字。

**Unicode:**
- General_Category — (Letter\|Mark\|Number\|Connector_Punctuation)

### 空白文字（`\s`）

**非Unicode:**
- `\t`, `\n`, `\v`, `\f`, `\r`, `\x20`

**Unicodeの場合:**
- U+0009, U+000A, U+000B, U+000C, U+000D, U+0085(NEL)
- General_Category — Line_Separator
- General_Category — Paragraph_Separator
- General_Category — Space_Separator

### 10進数字（`\d`）

**Unicode:** General_Category — Decimal_Number

### 特殊な改行とテキスト演算子

| パターン | 説明 |
|----------|------|
| `\R` | 汎用改行（文字クラス内では使用不可） |
| `\N` | 否定改行 `(?-m:.)` |
| `\O` | 真の任意文字 `(?m:.)` （独自機能） |
| `\X` | テキストセグメント（下記参照） |

#### `\R` - 汎用改行

`"\r\n"` または `\n`, `\v`, `\f`, `\r` にマッチ（`\r\n`から`\r`へのバックトラックなし）

**Unicodeの場合:** `"\r\n"` または `\n`, `\v`, `\f`, `\r` または U+0085, U+2028, U+2029

#### `\X` - テキストセグメント

等価: `\X === (?>\O(?:\Y\O)*)`

この演算子の意味はオプション `(?y{..})` の設定により変化します。

`\X`はマッチ開始位置が境界かどうかをチェックしません。これを確認したい場合は `\y\X` と書いてください。

**[拡張書記素クラスタモード]**（デフォルト）
- **Unicodeの場合:** [Unicode Standard Annex #29](http://unicode.org/reports/tr29/) を参照
- **非Unicodeの場合:** `\X === (?>\r\n|\O)`

**[単語モード]**
- 現在、このモードはUnicodeでのみサポートされています。
- [Unicode Standard Annex #29](http://unicode.org/reports/tr29/) を参照

### 文字プロパティ

文字プロパティは以下の方法で指定できます:

- `\p{property-name}`
- `\p{^property-name}` （否定）
- `\P{property-name}` （否定）
- `\pX` (X = C, L, M, N, P, S, Z)
- `\PX` (X = C, L, M, N, P, S, Z) （否定）

#### プロパティ名

**すべてのエンコーディングで動作:**
- Alnum, Alpha, Blank, Cntrl, Digit, Graph, Lower, Print, Punct, Space, Upper, XDigit, Word, ASCII

**EUC_JP, Shift_JISで動作:**
- Hiragana, Katakana

**UTF8, UTF16, UTF32で動作:**
- doc/UNICODE_PROPERTIES を参照

---

## 4. 量指定子

### 貪欲（Greedy）

| 量指定子 | 説明 |
|----------|------|
| `?` | 1回または0回 |
| `*` | 0回以上 |
| `+` | 1回以上 |
| `{n,m}` | 少なくともn回、最大でm回（n ≤ m） |
| `{n,}` | 少なくともn回 |
| `{,n}` | 0回以上n回以下（`{0,n}`） |
| `{n}` | ちょうどn回 |

### 最小量（Reluctant）

| 量指定子 | 説明 |
|----------|------|
| `??` | 0回または1回 |
| `*?` | 0回以上 |
| `+?` | 1回以上 |
| `{n,m}?` | 少なくともn回、最大でm回（n ≤ m） |
| `{n,}?` | 少なくともn回 |
| `{,n}?` | 0回以上n回以下（`{0,n}?`） |

> **注意:** `{n}?` は `ONIG_SYNTAX_JAVA` と `ONIG_SYNTAX_PERL` でのみ最小量演算子です。（この場合、そのように書く意味はありません。）デフォルトの構文では `/a{n}?/` === `/(?:a{n})?/`

### 独占的（Possessive）（貪欲かつ一度マッチしたらバックトラックしない）

| 量指定子 | 説明 |
|----------|------|
| `?+` | 1回または0回 |
| `*+` | 0回以上 |
| `++` | 1回以上 |
| `{n,m}` | 少なくともm回、最大でn回（n > m） |

> **注意:** `{n,m}+`, `{n,}+`, `{n}+` は `ONIG_SYNTAX_JAVA` と `ONIG_SYNTAX_PERL` でのみ独占的演算子です。

**例:** `/a*+/` === `/(?>a*)/`

---

## 5. アンカー

### 基本アンカー

| アンカー | 説明 |
|----------|------|
| `^` | 行頭 |
| `$` | 行末 |
| `\b` | 単語境界 |
| `\B` | 非単語境界 |
| `\A` | 文字列先頭 |
| `\Z` | 文字列末尾、または末尾の改行の前 |
| `\z` | 文字列末尾 |
| `\G` | 現在の検索試行が開始される位置 |
| `\K` | キープ（結果文字列の開始位置を保持） |

### テキストセグメント境界

| アンカー | 説明 |
|----------|------|
| `\y` | テキストセグメント境界 |
| `\Y` | テキストセグメント非境界 |

これらの演算子（`\y`, `\Y`）の意味はオプション `(?y{..})` の設定により変化します。

**[拡張書記素クラスタモード]**（デフォルト）
- **Unicodeの場合:** [Unicode Standard Annex #29](http://unicode.org/reports/tr29/) を参照
- **非Unicode:** `\r` と `\n` の間を除くすべての位置。

**[単語モード]**
- 現在、このモードはUnicodeでのみサポートされています。
- [Unicode Standard Annex #29](http://unicode.org/reports/tr29/) を参照

---

## 6. 文字クラス

### 文字クラス内の演算子

| 演算子 | 説明 |
|--------|------|
| `^...` | 否定クラス（最低優先度） |
| `x-y` | xからyまでの範囲 |
| `[...]` | 集合（文字クラス内の文字クラス） |
| `..&&..` | 積集合（低優先度、^より高い） |

**例:** `[a-w&&[^c-g]z]` ==> `([a-w] AND ([^c-g] OR z))` ==> `[abh-w]`

> **注意:** 文字クラス内で '[', '-', または ']' を通常の文字として使用したい場合は、'\'でエスケープする必要があります。

### POSIX括弧表現

形式: `[:xxxxx:]`、否定: `[:^xxxxx:]`

#### 非Unicodeの場合:

| 括弧表現 | 説明 |
|----------|------|
| `[:alnum:]` | 英字または数字 |
| `[:alpha:]` | 英字 |
| `[:ascii:]` | コード値: [0 - 127] |
| `[:blank:]` | `\t`, `\x20` |
| `[:cntrl:]` | 制御文字 |
| `[:digit:]` | 0-9 |
| `[:graph:]` | すべてのマルチバイトエンコード文字を含む |
| `[:lower:]` | 小文字 |
| `[:print:]` | すべてのマルチバイトエンコード文字を含む |
| `[:punct:]` | 句読点 |
| `[:space:]` | `\t`, `\n`, `\v`, `\f`, `\r`, `\x20` |
| `[:upper:]` | 大文字 |
| `[:xdigit:]` | 0-9, a-f, A-F |
| `[:word:]` | 英数字、"_"、およびマルチバイト文字 |

#### Unicodeの場合:

| 括弧表現 | 説明 |
|----------|------|
| `[:alnum:]` | Alphabetic \| Decimal_Number |
| `[:alpha:]` | Alphabetic |
| `[:ascii:]` | U+0000 - U+007F |
| `[:blank:]` | Space_Separator \| U+0009 |
| `[:cntrl:]` | U+0000 - U+001F, U+007F - U+009F |
| `[:digit:]` | Decimal_Number |
| `[:graph:]` | ^White_Space && ^[[:cntrl:]] && ^Unassigned && ^Surrogate |
| `[:lower:]` | Lowercase |
| `[:print:]` | [[:graph:]] \| Space_Separator |
| `[:punct:]` | Punctuation \| Symbol |
| `[:space:]` | White_Space |
| `[:upper:]` | Uppercase |
| `[:xdigit:]` | U+0030 - U+0039 \| U+0041 - U+0046 \| U+0061 - U+0066 (0-9, a-f, A-F) |
| `[:word:]` | Alphabetic \| Mark \| Decimal_Number \| Connector_Punctuation |

---

## 7. 拡張グループ

### コメントとオプション

**コメント:**
```
(?#...)
```

**部分式のオプション有効/無効:**
```
(?imxWDSPy-imxWDSP:subexp)
```

オプション:
- `i`: 大文字小文字を無視
- `m`: マルチライン（ドット（.）が改行にもマッチ）
- `x`: 拡張形式
- `W`: ASCIIのみの単語（`\w`, `\p{Word}`, `[[:word:]]`）およびASCIIのみの単語境界（`\b`）
- `D`: ASCIIのみの数字（`\d`, `\p{Digit}`, `[[:digit:]]`）
- `S`: ASCIIのみの空白（`\s`, `\p{Space}`, `[[:space:]]`）
- `P`: ASCIIのみのPOSIXプロパティ（W,D,Sを含む）: alnum, alpha, blank, cntrl, digit, graph, lower, print, punct, space, upper, xdigit, word
- `y{?}`: テキストセグメントモード
  - `y{g}`: 拡張書記素クラスタモード（デフォルト）
  - `y{w}`: 単語モード
  - [Unicode Standard Annex #29](http://unicode.org/reports/tr29/) を参照

**孤立オプション:**
```
(?imxWDSPy-imxWDSP)
```
次の ')' またはパターンの終わりまでグループを作成します。

例: `/ab(?i)c|def|gh/` == `/ab(?i:c|def|gh)/`

> **注意:** `(?i)` オプションは単語タイプ（`\w`, `\p{Word}`）には効果がありません。ただし、単語タイプが文字クラス内で使用される場合は有効です。しかし、これは単語タイプが `(?W)` オプションと一緒に使用される場合のみ問題になります。

**全体オプション:**
```
(?CIL)...
(?CIL:...)
```

このオプションは正規表現全体に影響する位置に配置する必要があります。

- `C`: ONIG_OPTION_DONT_CAPTURE_GROUP
- `I`: ONIG_OPTION_IGNORECASE_IS_ASCII
- `L`: ONIG_OPTION_FIND_LONGEST

### グループ

| パターン | 説明 |
|----------|------|
| `(?:subexp)` | 非キャプチャグループ |
| `(subexp)` | キャプチャグループ |
| `(?=subexp)` | 先読み |
| `(?!subexp)` | 否定先読み |
| `(?<=subexp)` | 後読み |
| `(?<!subexp)` | 否定後読み |
| `(?>subexp)` | アトミックグループ（subexp内でバックトラックしない） |
| `(?<name>subexp)` | 名前付きグループの定義 |
| `(?'name'subexp)` | 名前付きグループの定義（別構文） |

#### 後読みの制限

- 後読みおよび否定後読みでは、Absentストッパー `(?~|expr)` および範囲クリア `(?~|)` 演算子を使用できません。
- 後読みおよび否定後読みでは、大文字小文字無視オプションのサポートが制限されています。単一文字間の変換のみをサポートします。（Unicodeでの複数文字の変換はサポートしていません）

#### 名前付きグループ

- 名前の各文字は単語文字でなければなりません。
- 名前だけでなく、キャプチャグループと同様に番号も割り当てられます。
- 2つ以上の部分式に同じ名前を割り当てることが許可されています。

### コールアウト

#### 内容のコールアウト

```
(?{...contents...})           前進中のコールアウト
(?{...contents...}D)          Dは方向フラグ文字
                              D = 'X': 前進中および後退中
                                  '<': 後退中のみ
                                  '>': 前進中のみ
(?{...contents...}[tag])      タグ割り当て
(?{...contents...}[tag]D)
```

- 内容ではエスケープ文字は効果がありません。
- 内容は '{'で始めることができません。

```
(?{{{...contents...}}})       内容中のn回連続の '}' は
                              (n+1)回連続の {{{...}}} で許可されます。
```

許可されるタグ文字列の文字: `_` `A-Z` `a-z` `0-9`（先頭文字: `_` `A-Z` `a-z`）

#### 名前のコールアウト

```
(*name)
(*name{args...})              引数付き
(*name[tag])                  タグ割り当て
(*name[tag]{args...})
```

許可される名前文字列の文字: `_` `A-Z` `a-z` `0-9`（先頭文字: `_` `A-Z` `a-z`）
許可されるタグ文字列の文字: `_` `A-Z` `a-z` `0-9`（先頭文字: `_` `A-Z` `a-z`）

### Absent関数

**Absentリピータ**（田中あきら氏提案）:
```
(?~absent)
```
これは `.*`（より正確には `\O*`）のように動作しますが、`<absent>` にマッチする文字列を含まない範囲に制限されます。これは `(?~|(?:absent)|\O*)` の省略形です。`\O*` がリピータとして使用されます。

**Absent式**（独自）:
```
(?~|absent|exp)
```
これは "exp" のように動作しますが、`<absent>` にマッチする文字列を含まない範囲に制限されます。

**例:** `(?~|345|\d*)` に対して `"12345678"` ==> `"12"`, `"1"`, `""`

**Absentストッパー**（独自）:
```
(?~|absent)
```
この演算子を通過した後、文字列の右範囲は `<absent>` にマッチする文字列を含まない位置に制限されます。

**範囲クリア:**
```
(?~|)
```
Absentストッパーによる効果をクリアします。

> **注意:** ネストされたAbsent関数はサポートされておらず、動作は未定義です。

### If-then-else

```
(?(condition_exp)then_exp|else_exp)    if-then-else
(?(condition_exp)then_exp)             if-then
```

`condition_exp` は後方参照番号/名前、または通常の正規表現にできます。`condition_exp` が後方参照番号/名前の場合、`then_exp` と `else_exp` の両方を省略できます。その場合、後方参照の有効性チェッカーとして機能します。

#### 後方参照有効性チェッカー（独自）

```
(?(n)), (?(-n)), (?(+n)), (?(n+level)) ...
(?(<n>)), (?('-n')), (?(<+n>)) ...
(?(<name>)), (?('name')), (?(<name+level>)) ...
```

---

## 8. 後方参照

「グループを後方参照する」とは、実際にはそのグループ内の部分式にマッチした同じテキストに再マッチすることを意味します。

### 基本的な後方参照

| パターン | 説明 |
|----------|------|
| `\n` | （n ≥ 1）正規表現内のn番目のグループを後方参照 |
| `\k<n>`, `\k'n'` | （n ≥ 1）正規表現内のn番目のグループを後方参照 |
| `\k<-n>`, `\k'-n'` | （n ≥ 1）参照位置から逆方向にn番目のグループを後方参照 |
| `\k<+n>`, `\k'+n'` | （n ≥ 1）参照位置から順方向にn番目のグループを後方参照 |
| `\k<name>`, `\k'name'` | 指定された名前のグループを後方参照 |

複数のグループに割り当てられた名前で後方参照する場合、最後のその名前のグループが最初にチェックされ、マッチしなければその前のもの、というように、マッチするまで続きます。

> **注意:** 名前付きグループが定義されていて、ONIG_OPTION_CAPTURE_GROUPが設定されていない場合、番号による後方参照は禁止されています。

### 再帰レベル付き後方参照

（n ≥ 1, level ≥ 0）

```
\k<n+level>  \k'n+level'
\k<n-level>  \k'n-level'

\k<name+level>  \k'name+level'
\k<name-level>  \k'name-level'
```

参照位置に対して相対的な再帰レベル上のグループを指定します。

**例 1:**
```
/\A(?<a>|.|(?:(?<b>.)\g<a>\k<b>))\z/.match("reee")
/\A(?<a>|.|(?:(?<b>.)\g<a>\k<b+0>))\z/.match("reer")
```
`\k<b+0>` は同じ再帰レベル上の `(?<b>.)` を参照します。

**例 2:**
```ruby
r = Regexp.compile(<<'__REGEXP__'.strip, Regexp::EXTENDED)
(?<element> \g<stag> \g<content>* \g<etag> ){0}
(?<stag> < \g<name> \s* > ){0}
(?<name> [a-zA-Z_:]+ ){0}
(?<content> [^<&]+ (\g<element> | [^<&]+)* ){0}
(?<etag> </ \k<name+1> >){0}
\g<element>
__REGEXP__

p r.match("<foo>f<bar>bbb</bar>f</foo>").captures
```

---

## 9. 部分式呼び出し（「田中あきらスペシャル」）

*独自機能*

「グループを呼び出す」とは、実際にはそのグループ内の部分式を再実行することを意味します。

| パターン | 説明 |
|----------|------|
| `\g<n>`, `\g'n'` | （n ≥ 1）n番目のグループを呼び出す |
| `\g<0>`, `\g'0'` | ゼロ呼び出し（正規表現全体を呼び出す） |
| `\g<-n>`, `\g'-n'` | （n ≥ 1）呼び出し位置から逆方向にn番目のグループを呼び出す |
| `\g<+n>`, `\g'+n'` | （n ≥ 1）呼び出し位置から順方向にn番目のグループを呼び出す |
| `\g<name>`, `\g'name'` | 指定された名前のグループを呼び出す |

### 制限事項

- 左端の再帰呼び出しは許可されていません。
  - 例: `(?<name>a|\g<name>b)` => エラー
  - 例: `(?<name>a|b\g<name>c)` => OK

- 複数のグループに割り当てられた名前での呼び出しは許可されていません。

- 名前付きグループが定義されていて、ONIG_OPTION_CAPTURE_GROUPが設定されていない場合、番号による呼び出しは禁止されています。

- 呼び出されたグループのオプション状態は常に有効です。
  - 例: `/(?-i:\g<name>)(?i:(?<name>a)){0}/.match("A")`

---

## 10. キャプチャグループ

名前なしグループ `(...)` の動作は以下の条件で変化します。（ただし、名前付きグループは変化しません。）

### ケース 1: `/.../`（名前付きグループ未使用、オプションなし）

`(...)` はキャプチャグループとして扱われます。

### ケース 2: `/.../g`（名前付きグループ未使用、'g'オプション）

`(...)` は非キャプチャグループ `(?:...)` として扱われます。

### ケース 3: `/..(?<name>..)../`（名前付きグループ使用、オプションなし）

`(...)` は非キャプチャグループとして扱われます。番号による後方参照/呼び出しは許可されていません。

### ケース 4: `/..(?<name>..)../G`（名前付きグループ使用、'G'オプション）

`(...)` はキャプチャグループとして扱われます。番号による後方参照/呼び出しは許可されています。

**凡例:**
- `g`: ONIG_OPTION_DONT_CAPTURE_GROUP
- `G`: ONIG_OPTION_CAPTURE_GROUP

（'g'と'G'オプションはruby-dev MLで議論されました）

---

## 付録

### A-1. 構文依存オプション

**ONIG_SYNTAX_ONIGURUMA:**
- `(?m)`: ドット（.）が改行にもマッチ

**ONIG_SYNTAX_PERLおよびONIG_SYNTAX_JAVA:**
- `(?s)`: ドット（.）が改行にもマッチ
- `(?m)`: ^ が改行後にマッチ、$ が改行前にマッチ

### A-2. 独自拡張

- 16進数字文字タイプ: `\h`, `\H`
- 真の任意文字: `\O`
- テキストセグメント境界: `\y`, `\Y`
- 後方参照有効性チェッカー: `(?(...))` 
- 名前付きグループ: `(?<name>...)`, `(?'name'...)`
- 名前付き後方参照: `\k<name>`
- 部分式呼び出し: `\g<name>`, `\g<group-num>`
- Absent式: `(?~|...|...)`
- Absentストッパー: `(?~|...)`

### A-3. perl 5.8.0と比較して不足している機能

- `\N{name}`
- `\l`, `\u`, `\L`, `\U`, `\C`
- `(??{code})`

> **注意:** `\Q...\E` は ONIG_SYNTAX_PERL および ONIG_SYNTAX_JAVA で有効です。

### A-4. Ruby 1.8の日本語化GNU regex（バージョン0.12）との相違点

- 文字プロパティを追加（`\p{property}`, `\P{property}`）
- 16進数字文字タイプを追加（`\h`, `\H`）
- 後読みを追加: `(?<=fixed-width-pattern)`, `(?<!fixed-width-pattern)`
- 独占的量指定子を追加: `?+`, `*+`, `++`
- 文字クラス内の演算を追加: `[]`, `&&`（'[' は文字クラス内で通常の文字として使用する場合はエスケープが必要）
- 名前付きグループと部分式呼び出しを追加。
- マルチバイトエンコーディングが指定されている場合、8進数または16進数のシーケンスを文字クラス内でマルチバイトコード文字として扱うことができます。（例: `[\xa1\xa2]`, `[\xa1\xa7-\xa4\xa1]`）
- 文字クラス内でシングルバイト文字とマルチバイト文字の範囲を許可。（例: EUC-JPエンコーディングで `/[a-<<任意のEUC-JP文字>>]/`）
- 孤立オプションの効果範囲は次の ')' まで。（例: `(?:(?i)a|b)` は `(?:(?i:a|b))` として解釈され、`(?:(?i:a)|b)` ではありません。）
- 孤立オプションは前のパターンに対して透過的ではありません。（例: `a(?i)*` は構文エラーパターンです。）
- ペアになっていない左波括弧を通常の文字として許可。（例: `/{/`, `/({)/`, `/a{2,3/` など）
- 否定POSIXブラケット `[:^xxxx:]` をサポート。
- POSIXブラケット `[:ascii:]` を追加。
- 先読みの繰り返しは許可されていません。（例: `/(?=a)*/`, `/(?!b){5}/`）
- 大文字小文字無視オプションはエスケープシーケンスに対して有効。（例: `/\x61/i =~ "A"`）
- 範囲量指定子では、最小値の数値は省略可能。（`/a{,n}/` == `/a{0,n}/`。最小値と最大値の両方の省略は許可されていません: `/a{,}/`）
- `/{n}?/` は最小量量指定子ではありません。（`/a{n}?/` == `/(?:a{n})?/`）
- 無効な後方参照はチェックされ、エラーが発生します。（`/\1/`, `/(a)\2/`）
- 無限ループ内のゼロ幅マッチは繰り返しを停止し、キャプチャグループの状態変化が停止条件としてチェックされます。（`/(?:()|())*\1\2/ =~ ""`、`/(?:\1a|())*/ =~ "a"`）

---

## 11. 置換参照

`regex_replace` を使用する際、置換文字列内で以下の参照を使用してマッチした内容を挿入できます:

### 標準参照

| 参照 | 説明 |
|------|------|
| `$n` | 番号参照。n番目のキャプチャグループにマッチした文字列を挿入（n ≥ 1）。 |
| `$&` | マッチ全体。完全なマッチを挿入。 |
| `` $` `` | プレフィックス。マッチ前のテキストを挿入。 |
| `$'` | サフィックス。マッチ後のテキストを挿入。 |
| `$$` | リテラルドル記号。単一の `$` を挿入。 |

### Oniguruma固有の参照

以下の参照は `oniguruma` フラグが指定されている場合のみ利用可能です:

| 参照 | 説明 |
|------|------|
| `${n}` | 安全な番号参照。直後に数字を続けることができます（例: `${1}0` はグループ1の後に'0'を挿入）。 |
| `\k<name>` | 名前付き参照。名前付きグループにマッチした文字列を挿入。 |
| `${name}` | 名前付き参照。名前付きグループ挿入の別構文。 |
| `\n` | 番号参照。n番目のキャプチャグループにマッチした文字列を挿入（n ≥ 1）。 |
| `\0` | マッチ全体。`$&` と等価。 |
| `\\` | リテラルバックスラッシュ。単一の `\` を挿入。 |

## 例

```cpp
// 標準の $1, $2 参照
regex re(R"((\w+):(\w+))");
string result = regex_replace("key:value", re, "$2=$1");
// result: "value=key"

// $& でマッチ全体
regex re2(R"(\w+)");
string result2 = regex_replace("hello world", re2, "[$&]");
// result2: "[hello] [world]"

// Onigurumaフラグでの名前付き参照
regex re3(R"((?<word>\w+))", regex::oniguruma);
string result3 = regex_replace("hello", re3, "${word}!");
// result3: "hello!"
```

---

## 参照

- [Unicode Standard Annex #29 - Unicode Text Segmentation](http://unicode.org/reports/tr29/)
- [RE.txt](RE.txt) - オリジナル英語プレーンテキストリファレンス（正式ソース）
- [RE_ja.txt](RE_ja.txt) - 日本語プレーンテキストリファレンス（正式ソース）
